gof_map = c("nobs", "r.squared", "adj.r.squared"),
# notes = c("Data weighted by turnout."),
output = "output/app_tab4_models_precariousness.tex")
modelsummary(list(swd1_round1_e, swd3_round1_e,
swd4_round1_e, swd5_round1_e
),
stars = c("*"=.05, "**"=.01, "***"=0.001),
coef_rename = c(
"voted_1r" = "Voted (R1)",
"voted_2r" = "Voted (R2)",
"voter_typeVoted for winner" = "Winner",
"voter_typeVoted for loser" = "Loser",
"prez_vote_typefull winner" = "Full winner (A)",
"prez_vote_typesub-optimal winner" = "Sub-optimal winner (B)",
"prez_vote_typepartial loser" = "Partial loser (C)",
"prez_vote_typefull loser" = "Full loser (D)",
"stable_voter" = "Stable winner",
"swd_pre" = "Pre-election SWD",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"pol_interest_num" = "Pol. interest",
"pol_knowledge" = "Pol. knowledge",
"party_close" = "Feels close to a party",
"duty_to_vote" = "Duty to vote",
"econ_precariousness2" = "Economic  precariousness",
"soc_class_rUnemployed" = "Class: Unemployed",
"soc_class_rEcon. inactive (student, in household)" = "Class: Econ. inactive",
"soc_class_rPensioner" = "Class: Pensioner",
"soc_class_rManager/Businessperson"= "Class: Manager/Businessperson",
"soc_class_rFreelancer" = "Class: Freelancer",
"(Intercept)"="Intercept"
),
fmt = 2,
gof_map = c("nobs", "r.squared", "adj.r.squared"),
notes = c("Data weighted by turnout.")
)
cz_2023_all_waves_resp %>% select(vote_intention_w1, voted_1r) %>% table()
cz_2023_all_waves_resp %>% select(vote_intention_w1, voted_2r) %>% table()
cz_2023_all_waves_resp_d <- cz_2023_all_waves_resp %>%
mutate(swd_change_w2_w1 = SWD_w2 - SWD_w1,
turnout_change_1r = voted_1r - vote_intention_w1,
turnout_change_2r = voted_2r - vote_intention_w1)
cz_2023_all_waves_resp_d <- cz_2023_all_waves_resp %>%
mutate(swd_change_w2_w1 = SWD_w2 - SWD_w1,
turnout_change_1r = voted_1r - vote_intention_w1,
turnout_change_2r = voted_2r - vote_intention_w1)
ce0_round1_d <- glm(voted_1r ~ 1,
data = cz_2023_all_waves_resp_d,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce2_round1_d <- glm(voted_1r ~ swd_change_w2_w1 + female + age +
postsecondary_edu + duty_to_vote +
pol_interest_num + pol_knowledge + party_close,
data = cz_2023_all_waves_resp_d,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce0_round2_d <- glm(voted_2r ~ 1,
data = cz_2023_all_waves_resp_d,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce2_round2_d <- glm(voted_2r ~ swd_change_w2_w1 + female +
age + postsecondary_edu + duty_to_vote +
pol_interest_num + pol_knowledge + party_close,
data = cz_2023_all_waves_resp_d,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
tch_round1_d <- lm_robust(turnout_change_1r ~ swd_change_w2_w1 +
female + age +
postsecondary_edu + duty_to_vote +
pol_interest_num + pol_knowledge + party_close,
data = cz_2023_all_waves_resp_d,
weights = weight_turnout,
se_type = "stata")
tch_round2_d <- lm_robust(turnout_change_2r ~ swd_change_w2_w1 +
female + age +
postsecondary_edu + duty_to_vote +
pol_interest_num + pol_knowledge + party_close,
data = cz_2023_all_waves_resp_d,
weights = weight_turnout,
se_type = "stata")
modelsummary(list("Turnout (Round 1)" = ce2_round1_d,
"Turnout (Round 2)" = ce2_round2_d,
"Turnout - Vote intention (R1)"=tch_round1_d,
"Turnout - Vote intention (R2)"=tch_round2_d),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
# "SWD_w1" = "Pre-election satisfaction (Wave 1)",
# "SWD_w4" = "Post-election satisfaction (Wave 4)",
"swd_change_w2_w1" = "SWD change (W2 - W1)",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)" = "Intercept"
),
add_rows = pr2,
# notes = c("Data weighted by turnout."),
# title = "Turnout and satisfaction with democracy, 2023 Czech presidential election",
gof_map = "nobs" # ,
# output = "output/tab3_models.tex"
)
tch_round2_d <- lm_robust(turnout_change_2r ~ swd_change_w2_w1 +
female + age +
postsecondary_edu + duty_to_vote +
pol_interest_num + pol_knowledge + party_close,
data = cz_2023_all_waves_resp_d,
weights = weight_turnout,
se_type = "stata")
pr2 <- tribble(~term, ~m1, ~m2, ~m3, ~m4,
"PseudoR2 (McFadden)",
r2(ce0_round1_d, ce2_round1_d),
r2(ce0_round2_d, ce2_round2_d),
"", ""
# r2(ce0_round2, ce3_round2),
# r2(ce0_round2, ce4_round2)
)
model_n_vars <- broom::tidy(ce2_round1_d) %>%
filter(!grepl("election", term)) %>%
nrow()
attr(pr2, "position") <- (model_n_vars * 2) + 1
modelsummary(list("Turnout (Round 1)" = ce2_round1_d,
"Turnout (Round 2)" = ce2_round2_d,
"Turnout - Vote intention (R1)"=tch_round1_d,
"Turnout - Vote intention (R2)"=tch_round2_d),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
# "SWD_w1" = "Pre-election satisfaction (Wave 1)",
# "SWD_w4" = "Post-election satisfaction (Wave 4)",
"swd_change_w2_w1" = "SWD change (W2 - W1)",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)" = "Intercept"
),
add_rows = pr2,
# notes = c("Data weighted by turnout."),
# title = "Turnout and satisfaction with democracy, 2023 Czech presidential election",
gof_map = "nobs" # ,
# output = "output/tab3_models.tex"
)
?modelsummary
modelsummary(list("Turnout (Round 1)" = ce2_round1_d,
"Turnout (Round 2)" = ce2_round2_d,
"Turnout - Vote intention (R1)"=tch_round1_d,
"Turnout - Vote intention (R2)"=tch_round2_d),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
# "SWD_w1" = "Pre-election satisfaction (Wave 1)",
# "SWD_w4" = "Post-election satisfaction (Wave 4)",
"swd_change_w2_w1" = "SWD change (W2 - W1)",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)" = "Intercept"
),
add_rows = pr2,
# notes = c("Data weighted by turnout."),
# title = "Turnout and satisfaction with democracy, 2023 Czech presidential election",
gof_map = c("nobs", "adj.r.squared") # ,
# output = "output/tab3_models.tex"
)
ce0_all_c <- glm(voted ~ 1,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce1_all_c <- glm(voted ~ swd_pre + swd_post + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce2_all_c <- glm(voted ~ swd_pre + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce3_all_c <- glm(voted ~ swd_post + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
table(all_panels_both_waves$voted)
ce0_all_c <- glm(voted ~ 1,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce1_all_c <- glm(voted ~ swd_pre + swd_post + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce2_all_c <- glm(voted ~ swd_pre + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce3_all_c <- glm(voted ~ swd_post + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce4_all_c <- glm(voted ~ swd_pre + swd_post +
female + age + postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
fe_rows <- tribble(~term, ~m1, ~m2, ~m3, ~m4,
"Election FE", "Yes", "Yes", "Yes", "Yes")
fe_position <- broom::tidy(ce4_all_c) %>%
filter(!grepl("election", term)) %>%
nrow()
pr2 <- tribble(~term, ~m1, ~m2, ~m3, ~m4,
"PseudoR2 (McFadden)",
r2(ce0_all_c, ce1_all_c), r2(ce0_all_c, ce2_all_c),
r2(ce0_all_c, ce3_all_c), r2(ce0_all_c, ce4_all_c)) %>%
mutate(across(everything(), as.character))
additional_rows <- bind_rows(
fe_rows, pr2
)
attr(additional_rows, "position") <- c(fe_position * 2 + 1, fe_position * 2 + 2)
modelsummary(list(ce1_all_c, ce2_all_c, ce3_all_c, ce4_all_c),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge_pct" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
# coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/app_tab5_models_pol_knowledge.tex")
modelsummary(list(ce1_all_c, ce2_all_c, ce3_all_c, ce4_all_c),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2,
coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge_pct" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
# coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
ce0_all_c <- glm(voted ~ 1,
data = all_panels_both_waves %>%
filter(!is.na(pol_knowledge_pct)),
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce1_all_c <- glm(voted ~ swd_pre + swd_post + election,
data = all_panels_both_waves %>%
filter(!is.na(pol_knowledge_pct)),
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce2_all_c <- glm(voted ~ swd_pre + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce3_all_c <- glm(voted ~ swd_post + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce4_all_c <- glm(voted ~ swd_pre + swd_post +
female + age + postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
fe_rows <- tribble(~term, ~m1, ~m2, ~m3, ~m4,
"Election FE", "Yes", "Yes", "Yes", "Yes")
fe_position <- broom::tidy(ce4_all_c) %>%
filter(!grepl("election", term)) %>%
nrow()
pr2 <- tribble(~term, ~m1, ~m2, ~m3, ~m4,
"PseudoR2 (McFadden)",
r2(ce0_all_c, ce1_all_c), r2(ce0_all_c, ce2_all_c),
r2(ce0_all_c, ce3_all_c), r2(ce0_all_c, ce4_all_c)) %>%
mutate(across(everything(), as.character))
additional_rows <- bind_rows(
fe_rows, pr2
)
attr(additional_rows, "position") <- c(fe_position * 2 + 1, fe_position * 2 + 2)
modelsummary(list(ce1_all_c, ce2_all_c, ce3_all_c, ce4_all_c),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge_pct" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
# coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/app_tab5_models_pol_knowledge.tex")
modelsummary(list(ce1_all_c, ce2_all_c, ce3_all_c, ce4_all_c),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2,
coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge_pct" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
# coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
ce1c <- lm_robust(swd_diff ~ voted + swd_pre + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close +
election, data = all_panels_both_waves,
weights = weight_turnout,
se_type = "stata")
ce2c <- lm_robust(swd_diff ~ voter_type + swd_pre + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct + party_close +
election, data = all_panels_both_waves,
weights = weight_turnout,
se_type = "stata")
fe_rows <- tribble(~term, ~m1, ~m2,
"Country FE", "Yes", "Yes")
fe_position <- broom::tidy(ce2c) %>%
filter(!grepl("election", term)) %>%
nrow()
attr(fe_rows, "position") <- 21
modelsummary(list(ce1c, ce2c),
stars = c("*"=.05, "**"=.01, "***"=0.001),
coef_omit = "election[A-Za-z() ]+\\s[0-9]+$",
coef_map = c(
"voted" = "Voted",
"voter_typeVoted for winner" = "Winner",
"voter_typeVoted for loser" = "Loser",
"swd_pre" = "Pre-election SWD",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"pol_interest_num" = "Pol. interest",
"pol_knowledge_pct" = "Pol. knowledge",
"party_close" = "Feels close to a party",
"election_typepresidential" = "Presidential election",
"election_typeEP election" = "EP election",
"(Intercept)"="Intercept"
),
fmt = 2,
add_rows = fe_rows,
gof_map = c("nobs", "r.squared", "adj.r.squared"),
output = "output/app_tab6_models_pol_knowledge.tex")
modelsummary(list(ce1c, ce2c),
stars = c("*"=.05, "**"=.01, "***"=0.001),
coef_omit = "election[A-Za-z() ]+\\s[0-9]+$",
fmt = 2,
coef_map = c(
"voted" = "Voted",
"voter_typeVoted for winner" = "Winner",
"voter_typeVoted for loser" = "Loser",
"swd_pre" = "Pre-election SWD",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"pol_interest_num" = "Pol. interest",
"pol_knowledge_pct" = "Pol. knowledge",
"party_close" = "Feels close to a party",
"election_typepresidential" =
"Presidential election",
"election_typeEP election" = "EP election",
"(Intercept)"="Intercept"
),
add_rows = fe_rows,
gof_map = c("nobs", "r.squared", "adj.r.squared")
)
table(all_panels_both_waves$voter_type, useNA = "always")
table(all_panels_both_waves$voted, useNA = "always")
ce1c <- lm_robust(swd_diff ~ voted + swd_pre + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct +
party_close +
election, data = all_panels_both_waves %>%
filter(!is.na(voter_type)),
weights = weight_turnout,
se_type = "stata")
ce2c <- lm_robust(swd_diff ~ voter_type + swd_pre + female + age +
postsecondary_edu +
pol_interest_num + pol_knowledge_pct + party_close +
election, data = all_panels_both_waves,
weights = weight_turnout,
se_type = "stata")
fe_rows <- tribble(~term, ~m1, ~m2,
"Country FE", "Yes", "Yes")
fe_position <- broom::tidy(ce2c) %>%
filter(!grepl("election", term)) %>%
nrow()
attr(fe_rows, "position") <- 21
modelsummary(list(ce1c, ce2c),
stars = c("*"=.05, "**"=.01, "***"=0.001),
coef_omit = "election[A-Za-z() ]+\\s[0-9]+$",
coef_map = c(
"voted" = "Voted",
"voter_typeVoted for winner" = "Winner",
"voter_typeVoted for loser" = "Loser",
"swd_pre" = "Pre-election SWD",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"pol_interest_num" = "Pol. interest",
"pol_knowledge_pct" = "Pol. knowledge",
"party_close" = "Feels close to a party",
"election_typepresidential" = "Presidential election",
"election_typeEP election" = "EP election",
"(Intercept)"="Intercept"
),
fmt = 2,
add_rows = fe_rows,
gof_map = c("nobs", "r.squared", "adj.r.squared"),
output = "output/app_tab6_models_pol_knowledge.tex")
modelsummary(list(ce1c, ce2c),
stars = c("*"=.05, "**"=.01, "***"=0.001),
coef_omit = "election[A-Za-z() ]+\\s[0-9]+$",
fmt = 2,
coef_map = c(
"voted" = "Voted",
"voter_typeVoted for winner" = "Winner",
"voter_typeVoted for loser" = "Loser",
"swd_pre" = "Pre-election SWD",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"pol_interest_num" = "Pol. interest",
"pol_knowledge_pct" = "Pol. knowledge",
"party_close" = "Feels close to a party",
"election_typepresidential" =
"Presidential election",
"election_typeEP election" = "EP election",
"(Intercept)"="Intercept"
),
add_rows = fe_rows,
gof_map = c("nobs", "r.squared", "adj.r.squared")
)
### Table 4 with precariousness and social class
```{r}
cz_2023_all_waves_resp %>% select(vote_intention_w1, voted_2r) %>% table()
cz_2023_all_waves_resp_d %>% select(turnout_change_1r) %>% table()
cz_2023_all_waves_resp_d %>% select(turnout_change_2r) %>% table()
