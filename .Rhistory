y = "SWD change",
caption = "Using model 3 from table above")
tmp1 <- ggeffect(swd4_round1, "prez_vote_type")
tmp1$x <- factor(tmp1$x,
levels = c(
"full winner", "sub-optimal winner", "partial loser",
"full loser", "abstainer")
)
tmp1 %>%
plot() +
labs(title = "",
x = "Voter type",
y = "SWD change",
caption = "Using model 3 from table above")
tmp1 %>%
plot() +
labs(title = "",
x = "Voter type",
y = "SWD change",
caption = "Using model 3 from table above") +
scale_x_discrete(
labels = c("Full winner (A)", "Sub-optimal winner (B)",
"Partial loser (C)", "Full loser (D)",
"Abstainer (E)"))
tmp1 %>%
plot() +
labs(title = "",
x = "Voter type",
y = "SWD change",
caption = "Using model 3 from table above") +
scale_y_discrete(
labels = c("Full winner (A)", "Sub-optimal winner (B)",
"Partial loser (C)", "Full loser (D)",
"Abstainer (E)"))
tmp1 %>%
plot() +
labs(title = "",
x = "Voter type",
y = "SWD change",
caption = "Using model 3 from table above")
tmp1 %>%
plot() -> tmp2
tmp2
tmp2$data
tmp2$data$x
tmp2$data$group
tmp2$labels
tmp2$data$x
tmp2$data$x
tmp2$guides
tmp2$layers
tmp2$scales
tmp <- ggeffect(m2_w5, c("wave", "winner_stable2"))
tmp$group <- factor(tmp$group, levels = c(
"full winner", "sub-optimal winner", "partial loser",
"full loser", "abstainer"
))
p2 <- tmp %>%
plot() +
labs(title = "",
x = "Wave",
y = "SWD",
colour = "Voter type") +
theme(legend.position = "top") +
scale_colour_manual(name="Voter type",
labels=c("Full winner (A)",
"Sub-optimal winner (B)",
"Partial loser (C)",
"Full loser (D)",
"Full abstainer (E)"),
values = c("#E41A1B", "#377EB8",
"#4EAF4A", "#984EA4",
"#FF7F00")) +
guides(colour = guide_legend(nrow = 2))
ggsave("output/swd_change_w1_w5_voter_type5.png",
width = 7, height = 5)
?knitr::kable
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
# gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
?modelsummary
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_map = c("nobs"),
# gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
tar_load(all_panels_both_waves)
ce0_all <- glm(voted ~ 1,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce1_all <- glm(voted ~ swd_pre + swd_post + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce2_all <- glm(voted ~ swd_pre + female + age +
postsecondary_edu +
pol_interest_num + party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce3_all <- glm(voted ~ swd_post + female + age +
postsecondary_edu +
pol_interest_num + party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
ce4_all <- glm(voted ~ swd_pre + swd_post +
female + age + postsecondary_edu +
pol_interest_num +
party_close + election,
data = all_panels_both_waves,
family = binomial(link = "logit"),
weights = weight_turnout) %>%
coeftest(., vcov = vcovHC(., type="HC1"))
fe_rows <- tribble(~term, ~m1, ~m2, ~m3, ~m4,
"Election FE", "Yes", "Yes", "Yes", "Yes")
fe_position <- broom::tidy(ce4_all) %>%
filter(!grepl("election", term)) %>%
nrow()
pr2 <- tribble(~term, ~m1, ~m2, ~m3, ~m4,
"PseudoR2 (McFadden)",
r2(ce0_all, ce1_all), r2(ce0_all, ce2_all),
r2(ce0_all, ce3_all), r2(ce0_all, ce4_all)) %>%
mutate(across(everything(), as.character))
additional_rows <- bind_rows(
fe_rows, pr2
)
attr(additional_rows, "position") <- c(fe_position * 2 + 1, fe_position * 2 + 2)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
attr(additional_rows, "position") <- c(fe_position * 2 + 1, fe_position * 2 + 1)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
attr(additional_rows, "position") <- c(fe_position * 2 + 2, fe_position * 2 + 2)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
attr(additional_rows, "position") <- c(fe_position * 2 + 1, fe_position * 2 + 1)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
attr(additional_rows, "position") <- c(fe_position * 2, fe_position * 2)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
attr(additional_rows, "position") <- c(fe_position * 2 + 1, fe_position * 2 + 1)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
attr(additional_rows, "position") <- c(fe_position * 2 + 2, fe_position * 2 + 1)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
attr(additional_rows, "position") <- c(fe_position * 2, fe_position * 2 + 1)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
attr(additional_rows, "position") <- c(fe_position * 2 + 1, fe_position * 2 + 2)
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
output = "output/tab5_models.tex")
modelsummary(list(ce1_all, ce2_all, ce3_all, ce4_all),
stars = c("*"=.05, "**"=.01, "***"=0.001),
fmt = 2, coef_map = c(
"swd_pre" = "Pre-election satisfaction",
"swd_post" = "Post-election satisfaction",
"female" = "Female",
"age" = "Age",
"postsecondary_edu" = "Post-secondary education",
"duty_to_vote" = "Duty to vote",
"pol_interest_num" = "Interest in politics",
"pol_knowledge" = "Political knowledge",
"party_close" = "Feels close to a party",
"(Intercept)"="Intercept"
),
coef_omit = "election",
gof_omit = "AIC|BIC",
add_rows = additional_rows,
title = "Turnout and satisfaction with democracy, all panels (without CZ 2023)")
