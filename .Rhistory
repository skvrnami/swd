get_value_label(ro_2009$PW2)
get_value_label <- function(x){
labels <- attr(x, "labels")
data.frame(
value = unname(labels),
label = names(labels)
) # %>% tidyr::pivot_wider(., names_from = "value", values_from = "label",
#                         names_glue = "value_{.value}")
}
get_value_label(ro_2009$PW2)
get_value_label(ro_2009$PW2) %>% tidyr::pivot_wider()
get_value_label(ro_2009$PW2) %>% tidyr::pivot_wider(., names_from = value)
get_value_label(ro_2009$PW2) %>% tidyr::pivot_wider(., names_from = value, values_from = label)
get_value_label(ro_2009$PW2) %>% tidyr::pivot_wider(., names_from = value, values_from = label, names_glue = "value_{value}")
possibly_get_value_label <- purrr::possibly(get_value_label)
purrr::map_dfr(colnames(ro_2009), function(x) possibly_get_value_label(ro_2009[[x]]))
data.frame(
value = unname(labels),
label = names(labels)
) %>% tidyr::pivot_wider(
., names_from = as.character(value),
values_from = label,
names_glue = "value_{value}"
)
get_value_label <- function(x){
labels <- attr(x, "labels")
data.frame(
value = unname(labels),
label = names(labels)
) %>% tidyr::pivot_wider(
., names_from = as.character(value),
values_from = label,
names_glue = "value_{value}"
)
}
possibly_get_value_label <- purrr::possibly(get_value_label)
purrr::map_dfr(colnames(ro_2009), function(x) possibly_get_value_label(ro_2009[[x]]))
possibly_get_value_label(ro_2009$BARCODE)
possibly_get_value_label(ro_2009$PW2)
get_value_label(ro_2009$PW2)
get_value_label <- function(x){
labels <- attr(x, "labels")
data.frame(
value = as.character(unname(labels)),
label = names(labels)
) %>% tidyr::pivot_wider(
., names_from = value,
values_from = label,
names_glue = "value_{value}"
)
}
possibly_get_value_label <- purrr::possibly(get_value_label)
get_value_label(ro_2009$PW2)
purrr::map_dfr(colnames(ro_2009), function(x) possibly_get_value_label(ro_2009[[x]]))
?relocate
?first
?last_col
purrr::map_dfr(colnames(ro_2009), function(x) possibly_get_value_label(ro_2009[[x]]) %>%
mutate(var_name = x) %>%
relocate(var_name, .before = everything()))
purrr::map_dfr(colnames(ro_2009), function(x) {
?///
purrr::map_dfr(colnames(ro_2009), function(x) {
tmp <- possibly_get_value_label(ro_2009[[x]])
if(!is.null(tmp)){
tmp %>%
mutate(var_name = x) %>%
relocate(var_name, .before = everything())
}})
get_value_labels_df <- function(df){
purrr::map_dfr(colnames(df), function(x) {
tmp <- possibly_get_value_label(df[[x]])
if(!is.null(tmp)){
tmp %>%
mutate(var_name = x) %>%
relocate(var_name, .before = everything())
}
})
}
tar_load(ro_2009_codebook)
ro_2009_codebook
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2009)
ro_2009$D10
ro_2009$Q19
ro_2009$D10
ro_2009$D10
levels(ro_2009$D10)
attr(ro_2009$D10, "labels")
names(attr(ro_2009$D10, "labels"))
names(attr(ro_2009$Q19, "labels"))
names(attr(ro_2009$Q24B, "labels"))
names(attr(ro_2009$Q21B, "labels"))
ro_2009$Q23XX
attr(ro_2009$Q23XX, "labels")
names(attr(ro_2009$Q23XX, "labels"))
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2009_final)
ro_lm3_1 <- lm(swd_diff ~ voted, data = ro_2009_final)
ro_lm3_1 <- lm(swd_diff ~ voted_2r, data = ro_2009_final)
ro_lm3_2 <- lm(swd_diff ~ voted_2r + swd_w1, data = ro_2009_final)
tab_model(list(ro_lm3_1, ro_lm3_2))
ro_lm4_1 <- lm(swd_diff ~ candidate_qualified_2nd, data = ro_2009_final)
tab_model(list(ro_lm4_1))
ro_lm4_1 <- lm(swd_diff ~ candidate_qualified_2nd + swd_w1, data = ro_2009_final)
tab_model(list(ro_lm4_1))
ro_lm4_2 <- lm(swd_diff ~ winner + swd_w1, data = ro_2009_final)
tab_model(list(ro_lm4_1, ro_lm4_2))
ro_lm4_2 <- lm(swd_diff ~ candidate_qualified_2nd + winner + swd_w1, data = ro_2009_final)
tab_model(list(ro_lm4_1, ro_lm4_2))
ro_2009_final$Q21B
levels(ro_2009_final$Q21B)
levels(ro_2009_final$Q24B)
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
ro_lm1_1 <- glm(voted_2r ~ swd_w1 + varcat + sex + studii, data = ro_2009_final)
tab_model(list(ro_lm1_1))
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p1v1)
tar_load(ro_2012_p1v2)
ro_2012_p1v1$ID
ro_2012_p1v2$ID
ro_2012_p1v2$Id
ro_2012_p1v1$age
ro_2012_p1v1 %>% left_join(., ro_2012_p1v2 %>% rename_with(., ~paste0(.x, "_w2"), .cols = -c(Id), by = c("ID"="Id"))
)
ro_2012_p1v1 %>% left_join(., ro_2012_p1v2 %>% rename_with(., ~paste0(.x, "_w2"), .cols = -c(Id)), by = c("ID"="Id"))
ro_2012_p1v1 %>% left_join(., ro_2012_p1v2 %>% rename_with(., ~paste0(.x, "_w2"), .cols = -c(Id)), by = c("ID"="Id")) %>% select(ID, age)
ro_2012_p1v2$age
ro_2012_p1v1$age
ro_2012_p1v1 %>% left_join(., ro_2012_p1v2 %>% rename_with(., ~paste0(.x, "_w2"), .cols = -c(Id)), by = c("ID"="Id")) %>% select(ID, age, age_w2)
tar_load(ro_2012_p1v3)
ro_2012_p1v3$ID
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p1)
ro_2012_p1$D10_w2
ro_2012_p1$D10_w3
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p1)
ro_2012_p1$D10
ro_2012_p1$Q5LH_AG1_w3
table(ro_2012_p1$Q5LH_AG1_w3)
table(ro_2012_p1$Q5LH_AG2_w3)
ro_2012_p1$Q5LH_AG2_w3
ro_2012_p1$Q5LH_AG1_w3
ro_2012_p1$Q5LH_AG2_w3
ro_2012_p1$Q5LH_AG2_w3
ro_2012_p1$Q5LH_AG2_w3
ro_2012_p1$Q5LH_AG1_w3
names(attr(ro_2012_p1$Q5LH_AG1_w3, "labels"))
names(attr(ro_2012_p1$Q5LH_AG2_w3, "labels"))
ro_2012_p1$age
ro_2012_p1$EDUC
ro_2012_p1$EDUC_w2
ro_2012_p1$EDUC
table(ro_2012_p1$EDUC)
names(attr(ro_2012_p1$EDUC, "labels"))
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
ro_2012_p1$GEN
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
ro_2012_p1$age
as.numeric(ro_2012_p1$age)
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p1_final)
ro2_lm2_1 <- glm(voted ~ swd_w1, data = ro_2012_p1_final)
ro2_lm2_2 <- glm(voted ~ swd_w3, data = ro_2012_p1_final)
ro2_lm2_3 <- glm(voted ~ swd_w1 + swd_w3, data = ro_2012_p1_final)
tab_model(list(ro2_lm2_1, ro2_lm2_2, ro2_lm2_3))
ro2_lm3_1 <- lm(swd_diff ~ voted, data = ro_2012_p1_final)
ro2_lm3_2 <- lm(swd_diff ~ voted + swd_w1, data = ro_2012_p1_final)
tab_model(list(ro2_lm3_1, ro2_lm3_2))
ro_2012_p1_final %>% select(Q5LH_CD_w3, Q5LH_CS_w3) %>% table(., useNA = "always")
library(paqr)
ro_2012_p1_final %>% tab(Q5LH_CD_w3, Q5LH_CS_w3)
ro_2012_p1_final %>% tab(P12V, Q5LH_CS_w3)
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p1_final)
ro_2012_p1_final$P12V
table(ro_2012_p1_final$P12V)
table(ro_2012_p1_final$P12V, useNA = "always")
ro_2012_p1_final %>% tab(P12V, Q5LH_CS_w3, stable_voter)
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p2v1)
tar_load(ro_2012_p2v2)
ro_2012_p2v1$D10
ro_2012_p2v2$D10
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p2)
View(ro_2012_p2)
ro_2012_p2$D10_w2
ro_2012_p2$Q19_w3
ro_2012_p2$Q15
ro_2012_p2$Q15_w3
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p2_final)
hist(ro_2012_p2_final$swd_diff_w2)
hist(ro_2012_p2_final$swd_diff_w2, bins = 10)
hist(ro_2012_p2_final$swd_diff_w2, 10)
?hist
hist(ro_2012_p2_final$swd_diff_w2, breaks = 10)
hist(ro_2012_p2_final$swd_diff_w2, breaks = 9)
table(ro_2012_p2_final$swd_diff_w2)
ro_2012_p2$Q5LH_AG1_w3
ro_2012_p2$EDUC_w2
ro_2012_p2$age_w2
ro_2012_p2$Q5LH_CD_w3
ro_2012_p2$P12V_w2
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_p2_final)
ro_2012_p2_final
tar_load(ro_2012_p1_final)
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
ro_2012_p2_final$GEN_w2
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(ro_2012_all)
ro2_lm3_1b <- lm(swd_diff_w2 ~ voted, data = ro_2012_all)
ro2_lm3_2b <- lm(swd_diff_w2 ~ voted + swd_w1, data = ro_2012_all)
ro2_lm3_2b <- lm(swd_diff_w2 ~ voted + swd_w2, data = ro_2012_all)
tab_model(list(ro2_lm3_1b, ro2_lm3_2b))
ro2_lm3_1 <- lm(swd_diff ~ voted, data = ro_2012_p1_final)
ro2_lm3_2 <- lm(swd_diff ~ voted + swd_w1, data = ro_2012_p1_final)
tab_model(list(ro2_lm3_1, ro2_lm3_2))
# same_candidate_in_2r
ro2_lm5_0 <- lm(swd_diff ~ winner + stable_voter + swd_w1,
data = ro_2012_p1_final)
ro2_lm5_1 <- lm(swd_diff ~ winner * stable_voter + swd_w1,
data = ro_2012_p1_final)
tab_model(list(ro2_lm5_0, ro2_lm5_1))
ro2_lm5_0b <- lm(swd_diff_w2 ~ winner + stable_voter + swd_w2,
data = ro_2012_all)
ro2_lm5_1b <- lm(swd_diff_w2 ~ winner * stable_voter + swd_w2,
data = ro_2012_all)
tab_model(list(ro2_lm5_0b, ro2_lm5_1b))
tab_model(list(ro2_lm5_0, ro2_lm5_1))
ro2_lm5_0b <- lm(swd_diff_w2 ~ winner + stable_voter + swd_w2,
data = ro_2012_all)
ro2_lm5_1b <- lm(swd_diff_w2 ~ winner * stable_voter + swd_w2,
data = ro_2012_all)
tab_model(list(ro2_lm5_0b, ro2_lm5_1b))
ro_2012_all %>% select(winner, stable_voter) %>% table(., useNA = "always")
tar_load(ro_2012_p2_final)
ro_2012_p2_final$Q5LH_CS_w3
table(ro_2012_p2_final$Q5LH_CS_w3)
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(de_2021_w18)
de_2021_w18$kp18_020
tar_load(de_2021_w19)
de_2021_w19$kp18_020
de_2021_w18$lfdn
de_2021_w18$sample
colnames(de_2021_w18)
View(de_2021_w18)
View(de_2021_w18$lfdn)
de_2021_w18$lfdn
as.numeric(de_2021_w18$lfdn)
inner_join(
de_2021_w18,
de_2021_w20,
by = "lfdn"
)
tar_load(de_2021_w20)
inner_join(
de_2021_w18,
de_2021_w20,
by = "lfdn"
)
?inner_join
inner_join(
de_2021_w18,
de_2021_w20,
by = "lfdn", suffix = c("_w18", "_w20")
)
inner_join(
de_2021_w18,
de_2021_w20,
by = "lfdn", suffix = c("_w18", "_w20")
) -> tmp
table(tmp$kp20_2601)
tmp$kp20_2601
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
tar_load(de_2021_panel)
de_2021_panel %>% filter(kp20_2601 != "Berlin")
de_2021_panel$kp18_020
table(de_2021_panel$kp18_020)
table(de_2021_panel$kp20_180)
de_2021_panel$kp20_180
levels(de_2021_panel$kp20_180)
de_2021_panel$kp20_180
table(de_2021_panel$kp20_180)
table(de_2021_panel$kp18_170)
de_2021_panel$kp18_170
attr(de_2021_panel$kp18_170, "labels")
levels(de_2021_panel$kp18_170)
table(de_2021_panel$kp18_170)
table(de_2021_panel$kp20_200b)
table(de_2021_panel$kp20_200)
table(de_2021_panel$kp20_200aa)
table(de_2021_panel$kp20_200aa, useNA = "always")
table(de_2021_panel$kp20_200ab, useNA = "always")
table(de_2021_panel$kp20_200ba, useNA = "always")
table(de_2021_panel$kp20_200bb, useNA = "always")
de_2021_panel$kp20_200bb
de_2021_panel$kp20_200ba
de_2021_panel$kp20_200ba
levels(de_2021_panel$kp20_200bb)
levels(de_2021_panel$kp20_200ba)
levels(de_2021_panel$kp20_2280)
table(de_2021_panel$kp20_2280)
table(de_2021_panel$kp20_2290_c2)
table(de_2021_panel$kp20_2280)
table(de_2021_panel$kp20_3490)
de_lm2_1 <- glm(voted ~ swd_w18, data = de_2021_panel)
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
#!/usr/bin/env Rscript
# This is a helper script to run the pipeline.
# Choose how to execute the pipeline below.
# See https://books.ropensci.org/targets/hpc.html
# to learn about your options.
targets::tar_make()
# targets::tar_make_clustermq(workers = 2) # nolint
# targets::tar_make_future(workers = 2) # nolint
de_lm3_1 <- lm(swd_diff ~ voted, data = de_2021_final)
tar_load(de_2021_final)
de_lm3_1 <- lm(swd_diff ~ voted, data = de_2021_final)
de_lm3_2 <- lm(swd_diff ~ voted + swd_w18, data = de_2021_final)
tab_model(list(de_lm3_1, de_lm3_2))
de_lm3_1b <- lm(swd_diff ~ voted, data = de_2021_final %>% filter(kp20_2601 != "Berlin"))
de_lm3_2b <- lm(swd_diff ~ voted + swd_w18, data = de_2021_final %>% filter(kp20_2601 != "Berlin"))
tab_model(list(de_lm3_1, de_lm3_2))
tab_model(list(de_lm3_1b, de_lm3_2b))
