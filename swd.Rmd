---
title: "Satisfaction with democracy"
author: "Michael Škvrňák"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: readable
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)

library(dplyr)
library(targets)
library(sjPlot)
library(modelsummary)

```

# Variables
## Satisfaction with democracy
- CZ 1996, 4-point scale: "Generally speaking, are you very satisfied, rather satisfied, rather dissatisfied or very dissatisfied with the way democracy functions in the Czech Republic?"  
- CZ 2023, 11-point scale: "In general, how satisfied are you in the way democracy works in the country?"
- RO 2009, 4-point scale: "In general, how satisfied are you in the way democracy works in Romania?" (Very satisfied, rather satisfied, rather dissatisfied, very dissatisfied)
- RO 2012, 4-point scale: "In general, how satisfied are you in the way democracy works in Romania?"
- PL + HU 2019, 11-point scale: "On the whole, how satisfied are you with the way democracy works in [COUNTRY NAME], where 0 means “not at all satisfied” and 10 means “completely satisfied”?"
- DE 2017, 5-point scale: "On the whole, how satisfied or dissatisfied are you with the way democracy works in Germany?" (very satisfied, fairly satisfied, neither satisfied nor dissatisfied, not very satisfied, not at all satisfied)

## Voter turnout
- dummy variable, 1 = voted in the election, 0 = did not vote
- DE 2017 - a combination of a variable from post-election survey (wave 8, question: "At the federal election on 24 September a lot of people did not manage to vote or did not participate in the election for other reasons. How about you?") and a option "I have already cast a postal vote" from question on vote intention from previous waves ("When elections are held a lot of people vote, others do not manage to vote or do not participate in elections for other reasons. How likely is it that you will vote in the federal election on 24 September 2017?"). People who answered that they casted a postal ballot were not asked the question on voter turnout in wave 8
- CZ 2023 - voted in the 2nd round

## Stable voter
- dummy variable, the respondent voted the same party as in previous national election
- CZ 1996: 1 = voted the same party in 1996 election as in 1992 election ("National Council vote in 1992 election", reported in the pre-election wave); 0 = otherwise
- RO 2009: 1 = voted the same candidate in the 2nd round as in the 1st round of 2009 presidential election
- RO 2012: 1 = voted the same party (or a coalition composed of a party that the respondent voted in 2008) in 2012 as in 2008 election (reported in the post-election wave) - voting to Chamber of Deputies counts
- PL 2019: 1 = voted the same party (or a coalition) in 2019 EP election as in the 2015 national election
- HU 2019: 1 = voted the same party in 2019 EP election as in the 2018 national election
- DE 2017: 1 = voted the same party in 2017 national election as in the 2013 national election (second/party vote counts)

## Stable intention
- dummy variable, the vote intention in the pre-election wave was the same as the vote choice in the election
- CZ 1996: 1 = the vote intention in pre-election wave is the same as vote choice in the election
- RO 2009: N/A
- RO 2012: 1 = the vote intention in pre-election wave is the same as vote choice in the election
- DE 2017: 1 = vote choice in wave 8 equals to vote intention in wave 7
- PL & HU 2019: 1 = the vote intention in pre-election wave is the same as vote choice in the election

## Political interest
- CZ 1996: 4-point scale (Would you say that you are interested in politics?: "Very interested", "Fairly interested", "A little interested", "Not at all interested")
- CZ 2023: 4-point scale
- RO 2009: 4-point scale (How interested are you in politics in general?: "Very interested", "Fairly interested", "A little interested", "Not at all interested")
- RO 2012: 4-point scale (How interested are you in politics in general?: "Very interested", "Fairly interested", "A little interested", "Not at all interested")
- PL 2019: 4-point scale (Generally speaking, how interested are you in politics?: "Very interested", "Fairly interested", "A little interested", "Not at all interested")
- HU 2019: 4-point scale (Generally speaking, how interested are you in politics?: "Very interested", "Fairly interested", "A little interested", "Not at all interested")
- DE 2017: 5-point scale ("Quite generally, how interested are you in politics?": very interested, somewhat interested, in between, not very interested, not interested at all)

## Political knowledge
- CZ 1996: 3 questions
    - Can you tell me how many percent of votes has to gain a political party in our country in the elections in order to get into the Parliament? (open-ended)
    - Who was the last minister of transportation before the elections? (open-ended)
    - How many members has our Parliament? (open-ended)
- CZ 2023: 6 questions
    - Are MPs elected using PR or majoritarian electoral system?
    - Is the President of the European Commission elected by the EU citizens?
    - Czech Republic was officially established in 1989. True or False?
    - The EU has currently 25 member states. True or False?
    - Are regional councillors selected based on the results of regional elections. True or False?
    - Canada is a permanent member of the UN Security Council. True or False?
- RO 2009: 8 questions (true/false)
    - The President of Romania is elected for a period of 4 years.
    - A person can only be president of Romania only for two terms.
    - According to the Constitution, the ministers of a Government are elected by the President
    - One of the roles of the president is to represent Romania in external relations.
    - In certain conditions, the president has the right to dissolve the Parliament.
    - In Romania, the polling stations are closed at new hour? in the evening.
    - According to the law, the election campaigns in Romania start 30 days before the elections.
    - The states of the European Union have the same number of parliamentarians in the European Parliament.
- PL & HU 2019: 5 questions
    - The members of which of the following EU institutions are directly elected by European citizens? (The European Commission, The European Parliament, The Council of the European Union, None of the above)
    - Jean-Claude Juncker is the current President of the European Commission. How did he become President? (He was directly elected by EU citizens, He was selected on the basis of an internal vote within the European Commission, He was approved by a majority of the members of the European Parliament, He was appointed without a vote taking place)
    - Which of the following EU institutions formally proposes new laws at the EU level? (The European Commission, The European Parliament, The Council of the European Union, All of the above)
    - Which of the following statements is not true? (All EU citizens have the right to work in another EU country, Mobile phone roaming charges have decreased within the EU, Expenditure on the salaries of the EU officials is the largest item in the EU budget, Individual EU countries cannot conclude their own trade agreements )
    - In which of the following EU institutions are the ministers of national governments represented? (The European Commission, The European Parliament, The Council of the European Union, None of the Above)
- DE 2017
    - Which percentage of votes does a party definitely need to send representatives to the Bundestag? (open-ended question)
    - What do you think: Which vote decides how many seats each party will have in parliament? (first vote, second vote, both equally important, don't know)
    - Who elects the Chancellor of the Federal Republic of Germany? (Federal Council, Federal Assembly, Federal Parliament, the people)
    - Which party do the following politicians belong to? (6 questions in total)
    - What is the current unemployment rate in Germany? (4, 6, 8, 10 percent, don't know)

## Party close

## Voting as a civic duty
- DE 2017: 5-point scale: "Please state to what extent you agree or disagree with each statement: l)  In a democracy, it is the duty of all citizens to vote regularly in elections." (strongly disagree, disagree, neither agree nor disagree, agree, strongly agree)

## Winner
- a respondent voted the party/candidate who won the election (the party with the largest vote share)
- CZ 1996: 1 = voted ODS, 0 = did not vote ODS
- CZ 2023: 1 = voted Petr Pavel
- RO 2009: 1 = voted Traian Basescu
- RO 2012: 1 = voted USL
- PL 2019: 1 = voted PiS
- HU 2019: 1 = voted FIDESZ
- DE 2017: 1 = voted CDU/CSU (in either first or second vote)

## Education
- dummy variable - 1 = post-secondary education, 0 = other education

## Age
- all data sets - numeric variable
- in German data derived from year of birth, year of birth was capped at "1955 and before", in that case the year of birth was taken as 1955.

# Presidential panels, descriptive stats

## CZ 2023

- 0-10 SWD scale
```{r}
tar_load(cz_2023)

cz_2023 %>% 
  group_by(winner_1r, winner_2r) %>% 
  filter(!is.na(winner_1r), !is.na(winner_2r)) %>% 
  summarise(across(matches("SWD_w[0-9]+"), ~mean(as.numeric(.x))), 
              n = n(), 
              .groups = "drop") %>% 
  arrange(desc(winner_1r), desc(winner_2r)) %>% 
  knitr::kable(., digits = 2)

cz_2023 %>% 
  group_by(winner_1r, winner_2r) %>% 
  filter(!is.na(winner_1r), !is.na(winner_2r)) %>% 
  mutate(vote_type = case_when(
    winner_1r == "didn't vote" | winner_2r == "didn't vote" ~ "didn't vote (at least in one round)", 
    TRUE ~ paste0(winner_1r, " + ", winner_2r)
  )) %>% 
  group_by(vote_type) %>% 
  summarise(across(matches("SWD_w[0-9]+"), ~mean(as.numeric(.x))), 
              n = n(), 
              .groups = "drop") %>% 
  arrange(desc(SWD_w4)) %>% 
  knitr::kable(., digits = 2)

```

## RO 2009

- 0-3 SWD scale. 
- Basescu ultimately won, Geoana lost

```{r}
tar_load(ro_2009_final)

ro_2009_final %>% 
  group_by(winner_1r, winner_2r) %>% 
  filter(!is.na(winner_1r), !is.na(winner_2r)) %>% 
  summarise(across(matches("swd_w[0-9]+"), ~mean(.x, na.rm = TRUE)), 
            n = n()) %>% 
  knitr::kable(., digits = 2)

ro_2009_final %>% 
  group_by(winner_1r, winner_2r) %>% 
  filter(!is.na(winner_1r), !is.na(winner_2r)) %>% 
  mutate(vote_type = case_when(
    winner_1r == "didn't vote" | winner_2r == "didn't vote" ~ "didn't vote (at least in one round)", 
    TRUE ~ paste0(winner_1r, " + ", winner_2r)
  )) %>% 
  group_by(vote_type) %>% 
  summarise(across(matches("swd_w[0-9]+"), ~mean(as.numeric(.x), na.rm = TRUE)), 
              n = n(), 
              .groups = "drop") %>% 
  arrange(desc(swd_w3)) %>% 
  knitr::kable(., digits = 2)



```


# Hypotheses from pre-analysis plan

- Hypothesis 1: Pre-Election satisfaction does not matter for participation when socio-demographic controls and other attitudinal drivers of participation are controlled for.  
- Hypothesis 2: Voter Turnout is more strongly associated with post-election satisfaction than pre-election satisfaction.  
- Hypothesis 3: Elections increase satisfaction with democracy among voters, but exert no effect on abstainers.  
- Hypothesis 4: The strongest increase is among those, whose preferred candidates qualified for the 2nd round (1st round of voting) or won the second round (2nd round of voting).  
- Hypothesis 5: The effect of winning is stronger for respondents with stable preferences.  

# All panels
```{r}
tar_load(all_panels)
```

## Dostupnost kontrolních proměnných
```{r}
all_panels %>% 
  group_by(election) %>% 
  summarise(across(c("female", "age", "postsecondary_edu", "pol_interest_num", 
                     "pol_knowledge_pct", "party_close", "duty_to_vote"), 
                   ~!all(is.na(.x)))) %>% 
  knitr::kable()
```


## Chicken & Egg replication

### Table 1
```{r}

ce1 <- glm(voted ~ swd_pre + swd_post + election, 
           data = all_panels,
           family = binomial(link = "logit"))
ce2 <- glm(voted ~ swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             election, 
           data = all_panels, 
           family = binomial(link = "logit"))
ce3 <- glm(voted ~ swd_post + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             election, 
           data = all_panels, 
           family = binomial(link = "logit"))
ce4 <- glm(voted ~ swd_pre + swd_post + 
             female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + 
             party_close + election, 
           data = all_panels, 
           family = binomial(link = "logit"))

modelsummary(list(ce1, ce2, ce3, ce4), 
             stars = TRUE)
```

```{r}
ggeffects::ggpredict(ce3, "swd_post") %>% 
  plot()
```

#### CZ 1996
```{r}
ce1_cz96 <- glm(voted ~ swd_pre + swd_post, 
           data = all_panels %>% filter(election == "CZ 1996"),
           family = binomial(link = "logit"))
ce2_cz96 <- glm(voted ~ swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "CZ 1996"),
           family = binomial(link = "logit"))
ce3_cz96 <- glm(voted ~ swd_post + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "CZ 1996"),
           family = binomial(link = "logit"))
ce4_cz96 <- glm(voted ~ swd_pre + swd_post + 
             female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + 
             party_close, 
           data = all_panels %>% filter(election == "CZ 1996"),
           family = binomial(link = "logit"))

modelsummary(list(ce1_cz96, ce2_cz96, ce3_cz96, ce4_cz96), 
             stars = TRUE)
```

#### CZ 2023
```{r}
ce1_cz23 <- glm(voted ~ swd_pre + swd_post, 
           data = all_panels %>% filter(election == "CZ 2023"),
           family = binomial(link = "logit"))
ce2_cz23 <- glm(voted ~ swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
               duty_to_vote, 
           data = all_panels %>% filter(election == "CZ 2023"),
           family = binomial(link = "logit"))
ce3_cz23 <- glm(voted ~ swd_post + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
               duty_to_vote, 
           data = all_panels %>% filter(election == "CZ 2023"),
           family = binomial(link = "logit"))
ce4_cz23 <- glm(voted ~ swd_pre + swd_post + 
             female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + 
             party_close + duty_to_vote, 
           data = all_panels %>% filter(election == "CZ 2023"),
           family = binomial(link = "logit"))

modelsummary(list(ce1_cz23, ce2_cz23, ce3_cz23, ce4_cz23), 
             stars = TRUE)
```

#### RO 2009
```{r}
ce1_ro09 <- glm(voted ~ swd_pre + swd_post, 
           data = all_panels %>% filter(election == "RO 2009"),
           family = binomial(link = "logit"))
ce2_ro09 <- glm(voted ~ swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "RO 2009"),
           family = binomial(link = "logit"))
ce3_ro09 <- glm(voted ~ swd_post + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "RO 2009"),
           family = binomial(link = "logit"))
ce4_ro09 <- glm(voted ~ swd_pre + swd_post + 
             female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + 
             party_close, 
           data = all_panels %>% filter(election == "RO 2009"),
           family = binomial(link = "logit"))

modelsummary(list(ce1_ro09, 
                  ce2_ro09, 
                  ce3_ro09, 
                  ce4_ro09), 
             stars = TRUE)
```

#### RO 2012
```{r}
ce1_ro12 <- glm(voted ~ swd_pre + swd_post, 
           data = all_panels %>% filter(election == "RO 2012"),
           family = binomial(link = "logit"))
ce2_ro12 <- glm(voted ~ swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + party_close, 
           data = all_panels %>% filter(election == "RO 2012"),
           family = binomial(link = "logit"))
ce3_ro12 <- glm(voted ~ swd_post + female + age + postsecondary_edu + 
             pol_interest_num + party_close, 
           data = all_panels %>% filter(election == "RO 2012"),
           family = binomial(link = "logit"))
ce4_ro12 <- glm(voted ~ swd_pre + swd_post + 
             female + age + postsecondary_edu + 
             pol_interest_num + 
             party_close, 
           data = all_panels %>% filter(election == "RO 2012"),
           family = binomial(link = "logit"))

modelsummary(list(ce1_ro12, 
                  ce2_ro12, 
                  ce3_ro12, 
                  ce4_ro12), 
             stars = TRUE)
```

#### PL 2019
```{r}
ce1_pl19 <- glm(voted ~ swd_pre + swd_post, 
           data = all_panels %>% filter(election == "PL 2019"),
           family = binomial(link = "logit"))
ce2_pl19 <- glm(voted ~ swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "PL 2019"),
           family = binomial(link = "logit"))
ce3_pl19 <- glm(voted ~ swd_post + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "PL 2019"),
           family = binomial(link = "logit"))
ce4_pl19 <- glm(voted ~ swd_pre + swd_post + 
             female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + 
             party_close, 
           data = all_panels %>% filter(election == "PL 2019"),
           family = binomial(link = "logit"))

modelsummary(list(ce1_pl19, 
                  ce2_pl19, 
                  ce3_pl19, 
                  ce4_pl19), 
             stars = TRUE)
```

#### HU 2019
```{r}
ce1_hu19 <- glm(voted ~ swd_pre + swd_post, 
           data = all_panels %>% filter(election == "HU 2019"),
           family = binomial(link = "logit"))
ce2_hu19 <- glm(voted ~ swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "HU 2019"),
           family = binomial(link = "logit"))
ce3_hu19 <- glm(voted ~ swd_post + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "HU 2019"),
           family = binomial(link = "logit"))
ce4_hu19 <- glm(voted ~ swd_pre + swd_post + 
             female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + 
             party_close, 
           data = all_panels %>% filter(election == "HU 2019"),
           family = binomial(link = "logit"))

modelsummary(list(ce1_hu19, 
                  ce2_hu19, 
                  ce3_hu19, 
                  ce4_hu19), 
             stars = TRUE)
```

#### DE 2017
```{r}
ce1_de17 <- glm(voted ~ swd_pre + swd_post, 
           data = all_panels %>% filter(election == "DE (Ost) 2017"),
           family = binomial(link = "logit"))
ce2_de17 <- glm(voted ~ swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "DE (Ost) 2017"),
           family = binomial(link = "logit"))
ce3_de17 <- glm(voted ~ swd_post + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "DE (Ost) 2017"),
           family = binomial(link = "logit"))
ce4_de17 <- glm(voted ~ swd_pre + swd_post + 
             female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + 
             party_close, 
           data = all_panels %>% filter(election == "DE (Ost) 2017"),
           family = binomial(link = "logit"))

modelsummary(list(ce1_de17, 
                  ce2_de17, 
                  ce3_de17, 
                  ce4_de17), 
             stars = TRUE)
```

### Table 2
#### All panels
```{r}
ce1b <- lm(swd_diff ~ voted + swd_pre + female + age + postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             election, data = all_panels)
ce2b <- lm(swd_diff ~ voted * election_type + swd_pre + female + age +
             postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             election, data = all_panels)
ce3b <- lm(swd_diff ~ voter_type + swd_pre + female + age +
             postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             election, data = all_panels)
ce4b <- lm(swd_diff ~ voter_type * election_type + swd_pre + female + age +
             postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             election, data = all_panels)
ce5b <- lm(swd_diff ~ prez_vote_type + swd_pre + female + age +
             postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             election, data = all_panels %>% filter(!is.na(winner_1r) & !is.na(winner_2r)))

modelsummary(list(ce1b, ce2b, ce3b, ce4b, ce5b), stars = TRUE)


ggeffects::ggpredict(ce2b, c("election_type", "voted")) %>% plot()
ggeffects::ggpredict(ce4b, c("election_type", "voter_type")) %>% plot()
```

#### CZ 1996
```{r}
ce1b_cz96 <- lm(swd_diff ~ voted + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
             data = all_panels %>% filter(election == "CZ 1996"))
ce2b_cz96 <- lm(swd_diff ~ voter_type + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
             data = all_panels %>% filter(election == "CZ 1996"))
modelsummary(list(ce1b_cz96, ce2b_cz96), stars = TRUE)
```

#### CZ 2023
```{r}
ce1b_cz23 <- lm(swd_diff ~ voted + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             duty_to_vote, 
           data = all_panels %>% filter(election == "CZ 2023"))
ce2b_cz23 <- lm(swd_diff ~ voter_type + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close + 
             duty_to_vote, 
           data = all_panels %>% filter(election == "CZ 2023"))
modelsummary(list(ce1b_cz23, ce2b_cz23), stars = TRUE)
```

#### RO 2009
```{r}
ce1b_ro09 <- lm(swd_diff ~ voted + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "RO 2009"))
ce2b_ro09 <- lm(swd_diff ~ voter_type + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "RO 2009"))
modelsummary(list(ce1b_ro09, ce2b_ro09), stars = TRUE)
```

#### RO 2012
```{r}
ce1b_ro12 <- lm(swd_diff ~ voted + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + party_close, 
           data = all_panels %>% filter(election == "RO 2012"))
ce2b_ro12 <- lm(swd_diff ~ voter_type + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + party_close, 
           data = all_panels %>% filter(election == "RO 2012"))

modelsummary(list(ce1b_ro12, ce2b_ro12), stars = TRUE)
```

#### PL 2019
```{r}
ce1b_pl19 <- lm(swd_diff ~ voted + swd_pre + female + age + 
                  postsecondary_edu + pol_interest_num + 
                  pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "PL 2019"))
ce2b_pl19 <- lm(swd_diff ~ voter_type + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "PL 2019"))
modelsummary(list(ce1b_pl19, ce2b_pl19), stars = TRUE)

```

#### HU 2019
```{r}
ce1b_hu19 <- lm(swd_diff ~ voted + swd_pre + female + age + 
                  postsecondary_edu + pol_interest_num + 
                  pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "HU 2019"))
ce2b_hu19 <- lm(swd_diff ~ voter_type + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "HU 2019"))
modelsummary(list(ce1b_hu19, ce2b_hu19), stars = TRUE)

```

#### DE 2017
```{r}
ce1b_de17 <- lm(swd_diff ~ voted + swd_pre + female + age + 
                  postsecondary_edu + pol_interest_num + 
                  pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "DE (Ost) 2017"))
ce2b_de17 <- lm(swd_diff ~ voter_type + swd_pre + female + age + 
                  postsecondary_edu + 
             pol_interest_num + pol_knowledge_pct + party_close, 
           data = all_panels %>% filter(election == "DE (Ost) 2017"))
modelsummary(list(ce1b_de17, ce2b_de17), stars = TRUE)

```


## H1
```{r}
lm1_1 <- glm(voted ~ swd_pre + factor(election), 
             data = all_panels, 
             family = binomial(link = "logit"))

# lm1_2 <- glm(voted ~ swd_pre + age + I(age^2) + female + 
#                  postsecondary_edu +
#                  party_close + 
                 # factor(election), data = all_panels)

# lm1_3 <- glm(voted ~ swd_pre + age + I(age^2) + female + 
#                  postsecondary_edu +
#                  pol_knowledge_pct + 
#                  party_close + 
#                  factor(election), data = all_panels)

lm1_4 <- glm(voted ~ swd_pre + age + I(age^2) + female + 
                 postsecondary_edu +
                 pol_interest_num + 
                 party_close + 
                 factor(election), data = all_panels, 
             family = binomial(link = "logit"))

create_fe_row <- function(coefs, n_models = 2){
    new_rows <- tibble(
        term = "Election FE", 
        models = rep("Yes", times = n_models),
        name = paste0("Model ", 1:n_models)
    ) %>% tidyr::pivot_wider(., id_cols = "term", 
                             names_from = name, values_from = models)
    
    attr(new_rows, "position") <- (length(coefs) * 2) + 1
    new_rows
}

coefs1 <- c(
    "(Intercept)"="(Intercept)", 
    "swd_pre"="Satisfaction w/ democracy (pre-election wave)", 
    "age" = "Age", 
    "I(age^2)" = "Age (squared)", 
    "female" = "Female", 
    "postsecondary_edu" = "Postsecondary education", 
    "pol_interest_num" = "Political interest",
    "party_close" = "Close to a party"
)
# tab_model(list(lm1_1, lm1_4))
new_rows <- create_fe_row(coefs1, 2)

modelsummary(
    list(lm1_1, lm1_4), 
    coef_map = coefs1, 
    add_rows = new_rows, 
    fmt = 2, stars = TRUE
)
```

## H2
```{r}
lm2_2 <- glm(voted ~ swd_post + age + I(age^2) + female + 
                 postsecondary_edu +
                 party_close + 
                 factor(election), data = all_panels)

lm2_3 <- glm(voted ~ swd_post + swd_pre + age + I(age^2) + female + 
                 postsecondary_edu +
                 pol_interest_num + 
                 party_close + 
                 factor(election), data = all_panels)

coefs2 <- c(
    "(Intercept)"="(Intercept)", 
    "swd_post"="Satisfaction w/ democracy (post-election wave)", 
    "age" = "Age", 
    "I(age^2)" = "Age (squared)", 
    "female" = "Female", 
    "postsecondary_edu" = "Postsecondary education", 
    "pol_interest_num" = "Political interest", 
    "party_close" = "Close to a party"
)
new_rows <- create_fe_row(coefs2, 2)

modelsummary(list(lm2_2, lm2_3), coef_map = coefs2, add_rows = new_rows, fmt = 2, stars = TRUE)
```

## H3
```{r}
lm3_1 <- lm(swd_diff ~ voted + swd_pre + age + I(age^2) + female + 
                 postsecondary_edu +
                 party_close + 
                 factor(election), data = all_panels)

lm3_2 <- lm(swd_diff ~ voted + swd_pre + age + I(age^2) + female + 
                 postsecondary_edu +
                 party_close + 
                 pol_interest_num + 
                 factor(election), data = all_panels)

# lm3_3 <- lm(swd_diff ~ voted + swd_pre + age + I(age^2) + female + 
#                  postsecondary_edu +
#                  party_close + 
#                  pol_knowledge_pct + 
#                  factor(election), data = all_panels)

coefs3 <- c(
    "(Intercept)"="(Intercept)", 
    "voted" = "Voted in the election",
    "swd_pre"="Satisfaction w/ democracy (pre-election wave)", 
    "age" = "Age", 
    "I(age^2)" = "Age (squared)", 
    "female" = "Female", 
    "postsecondary_edu" = "Postsecondary education", 
    "party_close" = "Close to a party",
    "pol_interest_num" = "Political interest"
)
new_rows3 <- create_fe_row(coefs3, 2)

modelsummary(list(lm3_1, lm3_2), coef_map = coefs3, add_rows = new_rows3, fmt = 2, stars = TRUE)
```

## H4

Data only from Romanian presidential election, no fixed effects.
```{r}
lm4_1 <- lm(swd_diff ~ candidate_qualified_2nd + swd_pre + 
                age + I(age^2) + female + 
                postsecondary_edu +
                party_close + pol_interest_num, 
               data = all_panels)
lm4_2 <- lm(swd_diff ~ candidate_qualified_2nd + winner + swd_pre + 
                age + I(age^2) + female + 
                postsecondary_edu +
                party_close + pol_interest_num, 
               data = all_panels)

coefs4 <- c(
    "(Intercept)"="(Intercept)", 
    "candidate_qualified_2nd" = "Preferred candidate qualified to 2nd round",
    "winner" = "Preferred candidate won election",
    "swd_pre"="Satisfaction w/ democracy (pre-election wave)", 
    "age" = "Age", 
    "I(age^2)" = "Age (squared)", 
    "female" = "Female", 
    "postsecondary_edu" = "Postsecondary education", 
    "party_close" = "Close to a party",
    "pol_interest_num" = "Political interest"
)
# new_rows4 <- create_fe_row(coefs4, 2)

modelsummary(list(lm4_1, lm4_2), coef_map = coefs4, fmt = 2, stars = TRUE)

```

## H5
```{r}
lm5_0 <- lm(swd_diff ~ winner + stable_voter + swd_pre +
                age + I(age^2) + female + 
                postsecondary_edu +
                party_close + 
                pol_interest_num + 
                factor(election), 
            data = all_panels)
lm5_1 <- lm(swd_diff ~ winner * stable_voter + swd_pre + 
                age + I(age^2) + female + 
                postsecondary_edu +
                party_close + 
                pol_interest_num + 
                factor(election), 
            data = all_panels)
lm5_2 <- lm(swd_diff ~ winner * stable_intention + swd_pre + 
                age + I(age^2) + female + 
                postsecondary_edu +
                party_close + 
                pol_interest_num + 
                factor(election), 
            data = all_panels)

coefs5 <- c(
    "(Intercept)"="(Intercept)", 
    "winner" = "Preferred candidate/party won",
    "stable_voter" = "Stable voter (prev. national election)",
    "stable_intention" = "Stable vote intention (wrt pre-election wave)",
    "swd_pre"="Satisfaction w/ democracy (pre-election wave)", 
    "age" = "Age", 
    "I(age^2)" = "Age (squared)", 
    "female" = "Female", 
    "postsecondary_edu" = "Postsecondary education", 
    "party_close" = "Close to a party",
    "pol_interest_num" = "Political interest"
)
new_rows5 <- create_fe_row(coefs5, 3)

modelsummary(list(lm5_0, lm5_1, lm5_2), coef_map = coefs5, 
             add_rows = new_rows5, fmt = 2, stars = TRUE)
```

# Czech Republic, parliamentary election 1996

```{r}
tar_load(cz_1996)

cz_1996 %>% 
  select(swd_pre, swd_post) %>% 
  table(., useNA = "always")

mean(cz_1996$swd_pre, na.rm = TRUE)
mean(cz_1996$swd_post, na.rm = TRUE)
mean(cz_1996$swd_diff, na.rm = TRUE)
```

## H1
```{r}
cz_lm1_1 <- glm(voted ~ swd_pre + age + I(age^2) + female +
                 postsecondary_edu, 
             data = cz_1996)
cz_lm1_2 <- glm(voted ~ swd_pre + age + I(age^2) + female + 
                 postsecondary_edu +
                 pol_interest_num + party_close, data = cz_1996)

tab_model(list(cz_lm1_1, cz_lm1_2))
```


## H2
```{r}
cz_lm2_1 <- glm(voted ~ swd_pre, data = cz_1996 %>% filter(both_waves))
cz_lm2_2 <- glm(voted ~ swd_post, data = cz_1996 %>% filter(both_waves))
cz_lm2_3 <- glm(voted ~ swd_pre + swd_post, data = cz_1996 %>% filter(both_waves))

tab_model(list(cz_lm2_1, cz_lm2_2, cz_lm2_3))
```

## H3
```{r}
cz_lm3_1 <- lm(swd_diff ~ voted, data = cz_1996 %>% filter(both_waves))
cz_lm3_2 <- lm(swd_diff ~ voted + swd_pre, data = cz_1996 %>% filter(both_waves))

tab_model(list(cz_lm3_1, cz_lm3_2))
```

## H4
Applicable only to presidential election.

## H5
```{r}
cz_lm5_0 <- lm(swd_diff ~ winner_party + stable_voter + swd_pre, 
            data = cz_1996 %>% filter(both_waves))
cz_lm5_1 <- lm(swd_diff ~ winner_party * stable_voter + swd_pre, 
            data = cz_1996 %>% filter(both_waves))
cz_lm5_2 <- lm(swd_diff ~ winner_party * stable_intention + swd_pre, 
            data = cz_1996 %>% filter(both_waves))

tab_model(list(cz_lm5_0, cz_lm5_1, cz_lm5_2))

cz_lm5_0b <- lm(swd_diff ~ winner_government + stable_voter + swd_pre, 
            data = cz_1996 %>% filter(both_waves))
cz_lm5_1b <- lm(swd_diff ~ winner_government * stable_voter + swd_pre, 
            data = cz_1996 %>% filter(both_waves))
cz_lm5_2b <- lm(swd_diff ~ winner_government * stable_intention + swd_pre, 
            data = cz_1996 %>% filter(both_waves))

tab_model(list(cz_lm5_0b, cz_lm5_1b, cz_lm5_2b))
```

# Czech Republic, 2023 presidential election
```{r}
tar_load(cz_2023)

cz_2023 %>% 
  select(swd_pre, swd_post) %>% 
  table(., useNA = "always")

mean(cz_2023$swd_pre, na.rm = TRUE)
mean(cz_2023$swd_post, na.rm = TRUE)
mean(cz_2023$swd_diff, na.rm = TRUE)
```

## H1
```{r}
cz_lm1_1 <- glm(voted ~ SWD_w2 + age + I(age^2) + female + postsecondary_edu, 
                data = cz_2023)
cz_lm1_2 <- glm(voted ~ SWD_w2 + age + I(age^2) + female + postsecondary_edu + 
                    pol_knowledge_pct + pol_interest_num + party_close, 
                data = cz_2023)

tab_model(list(cz_lm1_1, cz_lm1_2))
```

## H2
```{r}

cz_lm2_1 <- glm(voted ~ SWD_w2, data = cz_2023)
cz_lm2_2 <- glm(voted ~ SWD_w4, data = cz_2023)
cz_lm2_3 <- glm(voted ~ SWD_w2 + SWD_w4, data = cz_2023)

tab_model(list(cz_lm2_1, cz_lm2_2, cz_lm2_3))

```

## H3
```{r}
cz_lm3_1 <- lm(swd_diff ~ voted, data = cz_2023)
cz_lm3_2 <- lm(swd_diff ~ voted + SWD_w1, data = cz_2023)

tab_model(list(cz_lm3_1, cz_lm3_2))
```

## H4
```{r}
cz_lm4_1 <- lm(swd_diff ~ candidate_qualified_2nd + SWD_w2, 
               data = cz_2023)
cz_lm4_2 <- lm(swd_diff ~ candidate_qualified_2nd + winner + SWD_w2, 
               data = cz_2023)

tab_model(list(cz_lm4_1, cz_lm4_2))
```

## H5
```{r}
# same_candidate_in_2r
cz_lm5_0 <- lm(swd_diff ~ winner + stable_voter + SWD_w2,
            data = cz_2023)
# cz_lm5_1 <- lm(swd_diff ~ winner * stable_voter + SWD_w1,
#             data = cz_2023)

tab_model(list(cz_lm5_0 #, cz_lm5_1
               ))
```


# Romanian presidential election, 2009
```{r}
tar_load(ro_2009_final)

ro_2009_final %>% 
  select(swd_pre, swd_post) %>% 
  table(., useNA = "always")

mean(ro_2009_final$swd_pre, na.rm = TRUE)
mean(ro_2009_final$swd_post, na.rm = TRUE)
mean(ro_2009_final$swd_diff, na.rm = TRUE)
```

## H1
```{r}
ro_lm1_1 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu, 
                data = ro_2009_final)
ro_lm1_2 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu + 
                    pol_knowledge + pol_interest_num + party_close, 
                data = ro_2009_final)

tab_model(list(ro_lm1_1, ro_lm1_2))
```

## H2
```{r}

ro_lm2_1 <- glm(voted ~ swd_w1, data = ro_2009_final)
ro_lm2_2 <- glm(voted ~ swd_w3, data = ro_2009_final)
ro_lm2_3 <- glm(voted ~ swd_w1 + swd_w3, data = ro_2009_final)

tab_model(list(ro_lm2_1, ro_lm2_2, ro_lm2_3))

```

## H3
```{r}
ro_lm3_1 <- lm(swd_diff ~ voted, data = ro_2009_final)
ro_lm3_2 <- lm(swd_diff ~ voted + swd_w1, data = ro_2009_final)

tab_model(list(ro_lm3_1, ro_lm3_2))
```

## H4
```{r}
ro_lm4_1 <- lm(swd_diff ~ candidate_qualified_2nd + swd_w1, 
               data = ro_2009_final)
ro_lm4_2 <- lm(swd_diff ~ candidate_qualified_2nd + winner + swd_w1, 
               data = ro_2009_final)

tab_model(list(ro_lm4_1, ro_lm4_2))
```

## H5
```{r}
# same_candidate_in_2r
ro_lm5_0 <- lm(swd_diff ~ winner + stable_voter + swd_w1,
            data = ro_2009_final)
ro_lm5_1 <- lm(swd_diff ~ winner * stable_voter + swd_w1,
            data = ro_2009_final)

tab_model(list(ro_lm5_0, ro_lm5_1))
```

# Romanian parliamentary elections, 2012
```{r}
tar_load(ro_2012_p1_final)
tar_load(ro_2012_all)

ro_2012_all %>% 
  select(swd_pre, swd_post) %>% 
  table(., useNA = "always")

mean(ro_2012_all$swd_pre, na.rm = TRUE)
mean(ro_2012_all$swd_post, na.rm = TRUE)
mean(ro_2012_all$swd_diff_w2, na.rm = TRUE)

```

## H1
```{r}
ro2_lm1_1 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu, 
                 data = ro_2012_p1_final)
ro2_lm1_2 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu + 
                     pol_interest_num + party_close, 
                 data = ro_2012_p1_final)

# ro2_lm1_1b <- glm(voted ~ swd_w2 + age + age^2 + female + postsecondary_edu, 
#                   data = ro_2012_all)

tab_model(list(ro2_lm1_1, ro2_lm1_2))
```

## H2
```{r}

ro2_lm2_1 <- glm(voted ~ swd_w1, data = ro_2012_p1_final)
ro2_lm2_2 <- glm(voted ~ swd_w3, data = ro_2012_p1_final)
ro2_lm2_3 <- glm(voted ~ swd_w1 + swd_w3, data = ro_2012_p1_final)

tab_model(list(ro2_lm2_1, ro2_lm2_2, ro2_lm2_3))

ro2_lm2_1b <- glm(voted ~ swd_w2, data = ro_2012_all)
ro2_lm2_2b <- glm(voted ~ swd_w3, data = ro_2012_all)
ro2_lm2_3b <- glm(voted ~ swd_w2 + swd_w3, data = ro_2012_all)

tab_model(list(ro2_lm2_1b, ro2_lm2_2b, ro2_lm2_3b))

```

## H3
```{r}
ro2_lm3_1 <- lm(swd_diff ~ voted, data = ro_2012_p1_final)
ro2_lm3_2 <- lm(swd_diff ~ voted + swd_w1, data = ro_2012_p1_final)

tab_model(list(ro2_lm3_1, ro2_lm3_2))

ro2_lm3_1b <- lm(swd_diff_w2 ~ voted, data = ro_2012_all)
ro2_lm3_2b <- lm(swd_diff_w2 ~ voted + swd_w2, data = ro_2012_all)

tab_model(list(ro2_lm3_1b, ro2_lm3_2b))

```

## H4
Applicable only for presidential elections.

## H5

```{r}
# same_candidate_in_2r
ro2_lm5_0c <- lm(swd_diff_w2 ~ winner + stable_voter + swd_w2,
            data = ro_2012_all)
ro2_lm5_1c <- lm(swd_diff_w2 ~ winner * stable_voter + swd_w2,
            data = ro_2012_all)

tab_model(list(ro2_lm5_0c, ro2_lm5_1c))
```

```{r}
ro2_lm5_0 <- lm(swd_diff ~ winner + stable_intention + swd_w1,
            data = ro_2012_p1_final)
ro2_lm5_1 <- lm(swd_diff ~ winner * stable_intention + swd_w1,
            data = ro_2012_p1_final)

tab_model(list(ro2_lm5_0, ro2_lm5_1))

```

# Poland, EP election 2019

```{r}
tar_load(pl_2019)

pl_2019 %>% 
  select(swd_pre, swd_post) %>% 
  table(., useNA = "always")

mean(pl_2019$swd_pre, na.rm = TRUE)
mean(pl_2019$swd_post, na.rm = TRUE)
mean(pl_2019$swd_diff, na.rm = TRUE)
```


## H1
```{r}
pl_lm1_1 <- glm(voted ~ swd_pre + age + I(age^2) + female + postsecondary_edu, 
                data = pl_2019)
pl_lm1_2 <- glm(voted ~ swd_pre + age + I(age^2) + female + postsecondary_edu + 
                    pol_interest_num + party_close, 
                data = pl_2019)

tab_model(list(pl_lm1_1, pl_lm1_2))
```


## H2
```{r}
pl_lm2_1 <- glm(voted ~ swd_pre, data = pl_2019)
pl_lm2_2 <- glm(voted ~ swd_post, data = pl_2019)
pl_lm2_3 <- glm(voted ~ swd_pre + swd_post, data = pl_2019)

tab_model(list(pl_lm2_1, pl_lm2_2, pl_lm2_3))
```

## H3
```{r}
pl_lm3_1 <- lm(swd_diff ~ voted, data = pl_2019)
pl_lm3_2 <- lm(swd_diff ~ voted + swd_pre, data = pl_2019)

tab_model(list(pl_lm3_1, pl_lm3_2))
```

## H4
Applicable only to presidential election.

## H5
```{r}
pl_lm5_0 <- lm(swd_diff ~ winner_party + stable_voter + swd_pre,
               data = pl_2019)
pl_lm5_1 <- lm(swd_diff ~ winner_party * stable_voter + swd_pre,
               data = pl_2019)

tab_model(list(pl_lm5_0, pl_lm5_1))
```

```{r}
pl_lm5_0b <- lm(swd_diff ~ winner_party + stable_intention + swd_pre,
               data = pl_2019)
pl_lm5_1b <- lm(swd_diff ~ winner_party * stable_intention + swd_pre,
               data = pl_2019)

tab_model(list(pl_lm5_0b, pl_lm5_1b))
```

# Hungary, EP election 2019

```{r}
tar_load(hu_2019)

hu_2019 %>% 
  select(swd_pre, swd_post) %>% 
  table(., useNA = "always")

mean(hu_2019$swd_pre, na.rm = TRUE)
mean(hu_2019$swd_post, na.rm = TRUE)
mean(hu_2019$swd_diff, na.rm = TRUE)
```


## H1
```{r}
hu_lm1_1 <- glm(voted ~ swd_pre + age + I(age^2) + female + postsecondary_edu, 
                data = hu_2019)
hu_lm1_2 <- glm(voted ~ swd_pre + age + I(age^2) + female + postsecondary_edu + 
                    pol_interest_num + party_close, 
                data = hu_2019)

tab_model(list(hu_lm1_1, hu_lm1_2))
```


## H2
```{r}
hu_lm2_1 <- glm(voted ~ swd_pre, data = hu_2019)
hu_lm2_2 <- glm(voted ~ swd_post, data = hu_2019)
hu_lm2_3 <- glm(voted ~ swd_pre + swd_post, data = hu_2019)

tab_model(list(hu_lm2_1, hu_lm2_2, hu_lm2_3))
```

## H3
```{r}
hu_lm3_1 <- lm(swd_diff ~ voted, data = hu_2019)
hu_lm3_2 <- lm(swd_diff ~ voted + swd_pre, data = hu_2019)

tab_model(list(hu_lm3_1, hu_lm3_2))
```

## H4
Applicable only to presidential election.

## H5
```{r}
hu_lm5_0 <- lm(swd_diff ~ winner_party + stable_voter + swd_pre,
               data = hu_2019)
hu_lm5_1 <- lm(swd_diff ~ winner_party * stable_voter + swd_pre,
               data = hu_2019)

tab_model(list(hu_lm5_0, hu_lm5_1))
```

```{r}
hu_lm5_0b <- lm(swd_diff ~ winner_party + stable_intention + swd_pre,
               data = hu_2019)
hu_lm5_1b <- lm(swd_diff ~ winner_party * stable_intention + swd_pre,
               data = hu_2019)

tab_model(list(hu_lm5_0b, hu_lm5_1b))
```

# German Federal election 2017

```{r}
tar_load(de_2017_final)

de_2017_final %>% 
  select(swd_pre, swd_post) %>% 
  table(., useNA = "always")

mean(de_2017_final$swd_pre, na.rm = TRUE)
mean(de_2017_final$swd_post, na.rm = TRUE)
mean(de_2017_final$swd_diff, na.rm = TRUE)
```

## H1
```{r}
de_lm1_1 <- glm(voted ~ swd_pre + age + I(age^2) + female + postsecondary_edu,
                data = de_2017_final)
de_lm1_2 <- glm(voted ~ swd_pre + age + I(age^2) + female + postsecondary_edu + 
                    pol_interest_num + party_close,
                data = de_2017_final)

tab_model(list(de_lm1_1, de_lm1_2))
```

## H2
```{r}
de_lm2_1 <- glm(voted ~ swd_pre, data = de_2017_final)
de_lm2_2 <- glm(voted ~ swd_post, data = de_2017_final)
de_lm2_3 <- glm(voted ~ swd_pre + swd_post, data = de_2017_final)

tab_model(list(de_lm2_1, de_lm2_2, de_lm2_3))

```

## H3
```{r}
de_lm3_1 <- lm(swd_diff ~ voted, data = de_2017_final)
de_lm3_2 <- lm(swd_diff ~ voted + swd_pre, data = de_2017_final)

de_lm3_1b <- lm(swd_diff ~ voted, data = de_2017_final %>% 
                    filter(!(kp9_2601 == "Berlin" | kp1_2601 == "Berlin")))
de_lm3_2b <- lm(swd_diff ~ voted + swd_pre, data = de_2017_final %>% 
                    filter(!(kp9_2601 == "Berlin" | kp1_2601 == "Berlin")))

tab_model(list(de_lm3_1, de_lm3_2, de_lm3_1b, de_lm3_2b))

```

## H5
```{r}
de_lm5_0 <- lm(swd_diff ~ winner_party + stable_voter + swd_pre,
               data = de_2017_final)
de_lm5_1 <- lm(swd_diff ~ winner_party * stable_voter + swd_pre,
               data = de_2017_final)
de_lm5_0b <- lm(swd_diff ~ winner_party + stable_voter + swd_pre,
               data = de_2017_final %>% 
                   filter(!(kp9_2601 == "Berlin" | kp1_2601 == "Berlin")))
de_lm5_1b <- lm(swd_diff ~ winner_party * stable_voter + swd_pre,
               data = de_2017_final %>% 
                   filter(!(kp9_2601 == "Berlin" | kp1_2601 == "Berlin")))

tab_model(list(de_lm5_0, de_lm5_1, de_lm5_0b, de_lm5_1b))
```

# Checks

```{r}
cz_1996 %>% 
    count(vote_previous_nat_election, vote_choice, stable_voter, 
          sort = TRUE) %>% 
    DT::datatable()

ro_2012_all %>% 
    count(vote_previous_nat_election, vote_choice, stable_voter, 
          sort = TRUE) %>% 
    DT::datatable()

pl_2019 %>% 
    filter(!is.na(swd_diff)) %>% 
    count(vote_previous_nat_election, vote_choice, stable_voter, 
          sort = TRUE) %>% 
    DT::datatable()

hu_2019 %>% 
    filter(!is.na(swd_diff)) %>% 
    count(vote_previous_nat_election, vote_choice, stable_voter, 
          sort = TRUE) %>% 
    DT::datatable()

de_2017_final %>% 
    filter(!is.na(swd_diff)) %>% 
    count(vote_previous_nat_election, vote_choice, stable_voter, 
          sort = TRUE) %>% 
    DT::datatable()
```

