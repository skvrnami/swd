---
title: "Satisfaction with democracy"
author: "Michael Škvrňák"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: readable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)

library(dplyr)
library(targets)
library(sjPlot)

```

## Variables
### Satisfaction with democracy
- CZ 1996, 4-point scale: "Generally speaking, are you very satisfied, rather satisfied, rather dissatisfied or very dissatisfied with the way democracy functions in the Czech Republic?"  
- RO 2009, 4-point scale: "In general, how satisfied are you in the way democracy works in Romania?" (Very satisfied, rather satisfied, rather dissatisfied, very dissatisfied)
- RO 2012, 4-point scale: "In general, how satisfied are you in the way democracy works in Romania?"
- PL + HU 2019, 11-point scale: "On the whole, how satisfied are you with the way democracy works in [COUNTRY NAME], where 0 means “not at all satisfied” and 10 means “completely satisfied”?"
- DE 2017, 5-point scale: "On the whole, how satisfied or dissatisfied are you with the way democracy works in Germany?" (very satisfied, fairly satisfied, neither satisfied nor dissatisfied, not very satisfied, not at all satisfied)

### Voter turnout
- dummy variable, 1 = voted in the election, 0 = did not vote
- DE 2017 - a combination of a variable from post-election survey (wave 8, question: "At the federal election on 24 September a lot of people did not manage to vote or did not participate in the election for other reasons. How about you?") and a option "I have already cast a postal vote" from question on vote intention from previous waves ("When elections are held a lot of people vote, others do not manage to vote or do not participate in elections for other reasons. How likely is it that you will vote in the federal election on 24 September 2017?"). People who answered that they casted a postal ballot were not asked the question on voter turnout in wave 8

### Stable voter
- dummy variable, the respondent voted the same party as in previous national election
- CZ 1996: 1 = voted the same party in 1996 election as in 1992 election ("National Council vote in 1992 election", reported in the pre-election wave); 0 = otherwise

### Stable intention
- dummy variable, the vote intention in the pre-election wave was the same as the vote choice in the election

### Political interest

### Political knowledge

### Voting as a civic duty

### Winner

### Education
- dummy variable - 1 = post-secondary education, 0 = other education

### Age
- all data sets - numeric variable
- in German data derived from year of birth, year of birth was capped at "1955 and before", in that case the year of birth was taken as 1955.


## Hypotheses from pre-analysis plan:  

- Hypothesis 1: Pre-Election satisfaction does not matter for participation when socio-demographic controls and other attitudinal drivers of participation are controlled for.  
- Hypothesis 2: Voter Turnout is more strongly associated with post-election satisfaction than pre-election satisfaction.  
- Hypothesis 3: Elections increase satisfaction with democracy among voters, but exert no effect on abstainers.  
- Hypothesis 4: The strongest increase is among those, whose preferred candidates qualified for the 2nd round (1st round of voting) or won the second round (2nd round of voting).  
- Hypothesis 5: The effect of winning is stronger for respondents with stable preferences.  

# Czech Republic, parliamentary election 1996

```{r}
tar_load(cz_96_final)
```

## H1
```{r}
lm1_1 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu, 
             data = cz_96_final)
lm1_2 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu +
                 pol_knowledge + party_close, data = cz_96_final)

tab_model(list(lm1_1, lm1_2))
```


## H2
```{r}
lm2_1 <- glm(voted ~ swd_w1, data = cz_96_final %>% filter(both_waves))
lm2_2 <- glm(voted ~ swd_w2, data = cz_96_final %>% filter(both_waves))
lm2_3 <- glm(voted ~ swd_w1 + swd_w2, data = cz_96_final %>% filter(both_waves))

tab_model(list(lm2_1, lm2_2, lm2_3))
```

## H3
```{r}
lm3_1 <- lm(swd_diff ~ voted, data = cz_96_final %>% filter(both_waves))
lm3_2 <- lm(swd_diff ~ voted + swd_w1, data = cz_96_final %>% filter(both_waves))

tab_model(list(lm3_1, lm3_2))
```

## H4
Applicable only to presidential election.

## H5
```{r}
lm5_0 <- lm(swd_diff ~ winner_government + stable_voter + swd_w1, 
            data = cz_96_final %>% filter(both_waves))
lm5_1 <- lm(swd_diff ~ winner_government * stable_voter + swd_w1, 
            data = cz_96_final %>% filter(both_waves))
lm5_2 <- lm(swd_diff ~ winner_government * stable_intention + swd_w1, 
            data = cz_96_final %>% filter(both_waves))

tab_model(list(lm5_0, lm5_1, lm5_2))
```

# Romanian presidential election, 2009
```{r}
tar_load(ro_2009_final)
```

## H1
```{r}
ro_lm1_1 <- glm(voted_2r ~ swd_w1 + age + I(age^2) + female + postsecondary_edu, 
                data = ro_2009_final)
ro_lm1_2 <- glm(voted_2r ~ swd_w1 + age + I(age^2) + female + postsecondary_edu + 
                    pol_knowledge + pol_interest_num + party_close, 
                data = ro_2009_final)

tab_model(list(ro_lm1_1, ro_lm1_2))
```

## H2
```{r}

ro_lm2_1 <- glm(voted_2r ~ swd_w1, data = ro_2009_final)
ro_lm2_2 <- glm(voted_2r ~ swd_w3, data = ro_2009_final)
ro_lm2_3 <- glm(voted_2r ~ swd_w1 + swd_w3, data = ro_2009_final)

tab_model(list(ro_lm2_1, ro_lm2_2, ro_lm2_3))

```

## H3
```{r}
ro_lm3_1 <- lm(swd_diff ~ voted_2r, data = ro_2009_final)
ro_lm3_2 <- lm(swd_diff ~ voted_2r + swd_w1, data = ro_2009_final)

tab_model(list(ro_lm3_1, ro_lm3_2))
```

## H4
```{r}
ro_lm4_1 <- lm(swd_diff ~ candidate_qualified_2nd + swd_w1, data = ro_2009_final)
ro_lm4_2 <- lm(swd_diff ~ candidate_qualified_2nd + winner + swd_w1, data = ro_2009_final)

tab_model(list(ro_lm4_1, ro_lm4_2))
```

## H5
```{r}
# same_candidate_in_2r
ro_lm5_0 <- lm(swd_diff ~ winner + same_candidate_in_2r + swd_w1,
            data = ro_2009_final)
ro_lm5_1 <- lm(swd_diff ~ winner * same_candidate_in_2r + swd_w1,
            data = ro_2009_final)

tab_model(list(ro_lm5_0, ro_lm5_1))
```

# Romanian parliamentary elections, 2012
```{r}
tar_load(ro_2012_p1_final)
tar_load(ro_2012_all)
```

## H1
```{r}
ro2_lm1_1 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu, 
                 data = ro_2012_p1_final)
ro2_lm1_2 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu + 
                     pol_interest_num + party_close, 
                 data = ro_2012_p1_final)

# ro2_lm1_1b <- glm(voted ~ swd_w2 + age + age^2 + female + postsecondary_edu, 
#                   data = ro_2012_all)

tab_model(list(ro2_lm1_1, ro2_lm1_2))
```

## H2
```{r}

ro2_lm2_1 <- glm(voted ~ swd_w1, data = ro_2012_p1_final)
ro2_lm2_2 <- glm(voted ~ swd_w3, data = ro_2012_p1_final)
ro2_lm2_3 <- glm(voted ~ swd_w1 + swd_w3, data = ro_2012_p1_final)

tab_model(list(ro2_lm2_1, ro2_lm2_2, ro2_lm2_3))

ro2_lm2_1b <- glm(voted ~ swd_w2, data = ro_2012_all)
ro2_lm2_2b <- glm(voted ~ swd_w3, data = ro_2012_all)
ro2_lm2_3b <- glm(voted ~ swd_w2 + swd_w3, data = ro_2012_all)

tab_model(list(ro2_lm2_1b, ro2_lm2_2b, ro2_lm2_3b))

```

## H3
```{r}
ro2_lm3_1 <- lm(swd_diff ~ voted, data = ro_2012_p1_final)
ro2_lm3_2 <- lm(swd_diff ~ voted + swd_w1, data = ro_2012_p1_final)

tab_model(list(ro2_lm3_1, ro2_lm3_2))

ro2_lm3_1b <- lm(swd_diff_w2 ~ voted, data = ro_2012_all)
ro2_lm3_2b <- lm(swd_diff_w2 ~ voted + swd_w2, data = ro_2012_all)

tab_model(list(ro2_lm3_1b, ro2_lm3_2b))

```

## H4
Applicable only for presidential elections.

## H5
```{r}
# same_candidate_in_2r
ro2_lm5_0 <- lm(swd_diff ~ winner + stable_voter + swd_w1,
            data = ro_2012_p1_final)
ro2_lm5_1 <- lm(swd_diff ~ winner * stable_voter + swd_w1,
            data = ro_2012_p1_final)

tab_model(list(ro2_lm5_0, ro2_lm5_1))

ro2_lm5_0b <- lm(swd_diff_w2 ~ winner + stable_voter + swd_w2,
            data = ro_2012_all)
ro2_lm5_1b <- lm(swd_diff_w2 ~ winner * stable_voter + swd_w2,
            data = ro_2012_all)

tab_model(list(ro2_lm5_0b, ro2_lm5_1b))

```

# Poland, EP election 2019

```{r}
tar_load(pl_2019)
```


## H1
```{r}
pl_lm1_1 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu, 
                data = pl_2019)
pl_lm1_2 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu + 
                    pol_interest_num + party_close, 
                data = pl_2019)

tab_model(list(pl_lm1_1, pl_lm1_2))
```


## H2
```{r}
pl_lm2_1 <- glm(voted ~ as.numeric(swd_w1), data = pl_2019)
pl_lm2_2 <- glm(voted ~ as.numeric(swd_w2), data = pl_2019)
pl_lm2_3 <- glm(voted ~ as.numeric(swd_w1) + as.numeric(swd_w2), data = pl_2019)

tab_model(list(pl_lm2_1, pl_lm2_2, pl_lm2_3))
```

## H3
```{r}
pl_lm3_1 <- lm(swd_diff ~ voted, data = pl_2019)
pl_lm3_2 <- lm(swd_diff ~ voted + as.numeric(swd_w1), data = pl_2019)

tab_model(list(pl_lm3_1, pl_lm3_2))
```

## H4
Applicable only to presidential election.

## H5
```{r}
pl_lm5_0 <- lm(swd_diff ~ winner_country + stable_voter + swd_w1,
               data = pl_2019)
pl_lm5_1 <- lm(swd_diff ~ winner_country * stable_voter + swd_w1,
               data = pl_2019)

tab_model(list(pl_lm5_0, pl_lm5_1))
```

# Hungary, EP election 2019

```{r}
tar_load(hu_2019)
```


## H1
```{r}
hu_lm1_1 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu, 
                data = hu_2019)
hu_lm1_2 <- glm(voted ~ swd_w1 + age + I(age^2) + female + postsecondary_edu + 
                    pol_interest_num + party_close, 
                data = hu_2019)

tab_model(list(hu_lm1_1, hu_lm1_2))
```


## H2
```{r}
hu_lm2_1 <- glm(voted ~ as.numeric(swd_w1), data = hu_2019)
hu_lm2_2 <- glm(voted ~ as.numeric(swd_w2), data = hu_2019)
hu_lm2_3 <- glm(voted ~ as.numeric(swd_w1) + as.numeric(swd_w2), data = hu_2019)

tab_model(list(hu_lm2_1, hu_lm2_2, hu_lm2_3))
```

## H3
```{r}
hu_lm3_1 <- lm(swd_diff ~ voted, data = hu_2019)
hu_lm3_2 <- lm(swd_diff ~ voted + as.numeric(swd_w1), data = hu_2019)

tab_model(list(hu_lm3_1, hu_lm3_2))
```

## H4
Applicable only to presidential election.

## H5
```{r}
hu_lm5_0 <- lm(swd_diff ~ winner_country + stable_voter + swd_w1,
               data = hu_2019)
hu_lm5_1 <- lm(swd_diff ~ winner_country * stable_voter + swd_w1,
               data = hu_2019)

tab_model(list(hu_lm5_0, hu_lm5_1))
```


# German Federal election 2017

```{r}
tar_load(de_2017_final)
```

## H1
```{r}
de_lm1_1 <- glm(voted ~ swd_pre + age + I(age^2) + female + postsecondary_edu,
                data = de_2017_final)
de_lm1_2 <- glm(voted ~ swd_pre + age + I(age^2) + female + postsecondary_edu + 
                    pol_interest_num + party_close,
                data = de_2017_final)

tab_model(list(de_lm1_1, de_lm1_2))
```

## H2
```{r}
de_lm2_1 <- glm(voted ~ swd_pre, data = de_2017_final)
de_lm2_2 <- glm(voted ~ swd_post, data = de_2017_final)
de_lm2_3 <- glm(voted ~ swd_pre + swd_post, data = de_2017_final)

tab_model(list(de_lm2_1, de_lm2_2, de_lm2_3))

```

## H3
```{r}
de_lm3_1 <- lm(swd_diff ~ voted, data = de_2017_final)
de_lm3_2 <- lm(swd_diff ~ voted + swd_pre, data = de_2017_final)

de_lm3_1b <- lm(swd_diff ~ voted, data = de_2017_final %>% 
                    filter(!(kp9_2601 == "Berlin" | kp1_2601 == "Berlin")))
de_lm3_2b <- lm(swd_diff ~ voted + swd_pre, data = de_2017_final %>% 
                    filter(!(kp9_2601 == "Berlin" | kp1_2601 == "Berlin")))

tab_model(list(de_lm3_1, de_lm3_2, de_lm3_1b, de_lm3_2b))

```

## H5
```{r}
de_lm5_0 <- lm(swd_diff ~ winner_party + stable_voter + swd_pre,
               data = de_2017_final)
de_lm5_1 <- lm(swd_diff ~ winner_party * stable_voter + swd_pre,
               data = de_2017_final)
de_lm5_0b <- lm(swd_diff ~ winner_party + stable_voter + swd_pre,
               data = de_2017_final %>% 
                   filter(!(kp9_2601 == "Berlin" | kp1_2601 == "Berlin")))
de_lm5_1b <- lm(swd_diff ~ winner_party * stable_voter + swd_pre,
               data = de_2017_final %>% 
                   filter(!(kp9_2601 == "Berlin" | kp1_2601 == "Berlin")))

tab_model(list(de_lm5_0, de_lm5_1, de_lm5_0b, de_lm5_1b))
```

